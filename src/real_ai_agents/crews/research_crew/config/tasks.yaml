# Research Agent Crew Tasks - Sequential Process

scrape_listings:
  description: >
    Search real estate platforms for properties matching the criteria: {search_criteria}.
    Use Firecrawl to render dynamic content and extract raw listing data including 
    URLs, HTML content, and any visible property information. Target platforms 
    based on the location specified in the search criteria.
  expected_output: >
    A list of raw listing data objects containing: listing URLs, raw HTML/text content, 
    platform source, and extraction timestamp for each discovered property.
  agent: scraper

extract_property_data:
  description: >
    Parse the raw listing data and extract comprehensive property information.
    
    Required data to extract for each property:
    
    PROPERTY IMAGES:
    - All available image URLs (exterior, interior, rooms, amenities)
    - Image captions/descriptions if available
    - Primary/featured image identifier
    
    PROPERTY DETAILS:
    - Property title/headline
    - Property type (apartment, house, duplex, condo, studio, etc.)
    - Full address (street, city, state/region, postal code, country)
    - Price (sale price or rent amount with currency)
    - Price frequency for rentals (monthly, weekly, yearly)
    - Bedrooms count
    - Bathrooms count
    - Square footage/meters
    - Year built
    - Lot size (if applicable)
    - Parking spaces/garage info
    - Furnished status
    - Pet policy
    - Available date
    - Lease terms (for rentals)
    
    PROPERTY FEATURES:
    - Amenities list (pool, gym, balcony, garden, etc.)
    - Utilities included
    - Security features
    - Appliances included
    - Special features (waterfront, mountain view, etc.)
    
    PROPERTY DESCRIPTION:
    - Full listing description text
    - Neighborhood description if available
    
    CONTACT INFORMATION:
    - Agent/owner name
    - Phone number(s)
    - Email address
    - Brokerage/agency name
    - Agent photo URL if available
    
    LISTING METADATA:
    - Original listing URL
    - Platform source (Zillow, Realtor, etc.)
    - Listing ID on platform
    - Date listed
    - Days on market
    - Listing status (active, pending, etc.)
    
    Handle missing data gracefully by marking fields as null with extraction notes.
  expected_output: >
    A list of structured PropertyRecord objects containing:
    - images: array of {url, caption, is_primary}
    - details: {title, type, address, price, price_frequency, bedrooms, bathrooms, 
      sqft, year_built, lot_size, parking, furnished, pet_policy, available_date, lease_terms}
    - features: {amenities[], utilities[], security[], appliances[], special[]}
    - description: {full_text, neighborhood}
    - contact: {name, phone, email, brokerage, photo_url}
    - metadata: {listing_url, platform, listing_id, date_listed, days_on_market, status}
    - extraction_notes: any gaps or issues encountered
  agent: data_extractor
  context:
    - scrape_listings

validate_data:
  description: >
    Validate all extracted PropertyRecord objects for data quality:
    - Check required fields are present (address, price, at least one contact method)
    - Validate phone number formats
    - Verify image URLs are properly formatted
    - Flag any suspicious or incomplete records
    Continue processing even with gaps, but document all limitations.
  expected_output: >
    Validated PropertyRecord list with quality scores and validation notes for each 
    property. Include a summary of data quality issues found.
  agent: validator
  context:
    - extract_property_data

compile_research_report:
  description: >
    Compile all validated property records into a structured JSON report ready 
    for the Human Decision Gate. Organize data for frontend display with clear 
    sections for images, specs, and contact info.
  expected_output: >
    A comprehensive JSON file (research_results.json) containing all property 
    records organized for frontend presentation, with metadata about the search 
    and any data quality notes.
  agent: report_agent
  context:
    - validate_data
  output_file: output/research_results.json
